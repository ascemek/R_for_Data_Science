# Packages

library(tidyverse)
library(mosaic)
library(GGally)
library(readr)

wellbeing2016 <- read_csv("~/Google Drive/Fall2020/DWD1F20/DWD1 Capstones/Unit A/project/wellbeing2016.csv")

filter(wellbeing2016, Country == "United States of America") %>%
  View()

str(wellbeing2016)
ggpairs(wellbeing2016[,3:11])

names(wellbeing2016)

wellbeing2016 <- wellbeing2016 %>%
  mutate(isUS = (Country == "United States of America"))

cor(Wellbeing ~ Inequality, data = wellbeing2016)

lm(Wellbeing ~ Inequality, data = wellbeing2016)


ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point() + 
  stat_smooth(method = "lm", se = FALSE)

ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point(aes(colour = FootprintCategory))

ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point(aes(colour = FootprintCategory, size = isUS)) + 
  facet_wrap(~Region)

ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point(aes(colour = Region, size = isUS)) + 
  stat_smooth(method = "lm")

ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point(aes(colour = Region, size = isUS))
ggplot(wellbeing2016, aes(x = Inequality, y = Wellbeing)) + 
  geom_point(aes(colour = FootprintCategory, size = isUS))

gf_point(Wellbeing ~ Inequality, data = wellbeing2016, 
         color = ~Region)
gf_point(Wellbeing ~ Inequality, data = wellbeing2016, 
         color = ~FootprintCategory) + facet_wrap(~FootprintCategory, nrow = 3)


gf_point(Wellbeing ~ IneqAdjLifeExp, data = wellbeing2016, 
         color = ~FootprintCategory) # no US is close to max and some issues there
gf_point(Wellbeing ~ LifeExpectancy, data = wellbeing2016, 
         color = ~FootprintCategory) # no US is close to max and some issues there


wellbeing2016